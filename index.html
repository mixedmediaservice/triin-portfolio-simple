<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Triin Ruumet - Film Director & Producer</title>
    <link rel="stylesheet" href="styles.css">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="images/favicon.png">
    
    <!-- EmailJS SDK -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script>
        // Initialize EmailJS when page loads
        window.addEventListener('load', function() {
            if (typeof emailjs !== 'undefined') {
                emailjs.init("Q8mF-kCkl5IzUVp2b");
                console.log('EmailJS initialized successfully');
            } else {
                console.error('EmailJS failed to load');
            }
        });
    </script>
</head>
<body class="home-page">
    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-container">
            <div class="nav-logo">
                <a href="#home">TRIIN RUUMET</a>
            </div>
            <div class="nav-center">
                <ul class="nav-menu">
                    <li><a href="#films"><span class="content-en">FILMS</span><span class="content-ee">FILMID</span></a></li>
                    <li><a href="#commercial"><span class="content-en">COMMERCIAL</span><span class="content-ee">REKLAAM</span></a></li>
                    <li><a href="#about"><span class="content-en">ABOUT</span><span class="content-ee">BIO</span></a></li>
                    <li><a href="#contact"><span class="content-en">CONTACT</span><span class="content-ee">KONTAKT</span></a></li>
                    <!-- Mobile-only items -->
                    <li class="mobile-only" style="margin-top: 1rem; display: none;">
                        <div style="display: flex; justify-content: center; align-items: center; gap: 1rem;">
                            <a href="https://www.instagram.com/triin_ruumet/" target="_blank" rel="noopener noreferrer" class="mobile-instagram">
                                <img src="images/instagram-t.png" alt="Instagram" class="mobile-instagram-icon">
                            </a>
                            <div class="mobile-lang-switcher">
                                <button class="mobile-lang-btn active" onclick="switchLanguage('en')">EN</button>
                                <button class="mobile-lang-btn" onclick="switchLanguage('ee')">EE</button>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
            <div class="nav-right">
                <a href="https://www.instagram.com/triin_ruumet/" target="_blank" rel="noopener noreferrer" class="nav-instagram">
                    <img src="images/instagram-t.png" alt="Instagram" class="instagram-icon">
                </a>
                <div class="nav-lang-switcher">
                    <button class="nav-lang-btn active" onclick="switchLanguage('en')">EN</button>
                    <button class="nav-lang-btn" onclick="switchLanguage('ee')">EE</button>
                </div>
            </div>
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- Hero Section - Clean video only -->
    <section id="home" class="hero">
        <video class="hero-video" autoplay muted loop>
            <source src="images/hero-video.mp4" type="video/mp4">
        </video>
    </section>

    <!-- Films Section -->
    <section id="films" class="section">
        <h2 class="section-title"><span class="content-en">FILMS</span><span class="content-ee">FILMID</span></h2>
        <div class="films-grid">
            <div class="film-card" onclick="location.href='projects/dark-paradise.html'">
                <img src="images/films/dark-paradise/dark-paradise-cover.jpg" alt="Dark Paradise">
                <div class="film-overlay">
                    <h3 class="film-title">Dark Paradise</h3>
                    <p class="film-meta">2023 • Feature Film • 1hr 51min</p>
                </div>
            </div>
            <div class="film-card" onclick="location.href='projects/the-days-that-confused.html'">
                <img src="images/films/the-days-that-confused/the-days-that-confused-cover.jpg" alt="The Days That Confused">
                <div class="film-overlay">
                    <h3 class="film-title">The Days That Confused</h3>
                    <p class="film-meta">2016 • Feature Film • 1hr 45min</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Commercial Section -->
    <section id="commercial" class="section commercial">
        <h2 class="section-title"><span class="content-en">COMMERCIAL</span><span class="content-ee">REKLAAM</span></h2>
        <div class="commercial-grid">
            <div class="commercial-card" onclick="location.href='projects/saku-on-ice.html'">
                <img src="images/commercial/saku-on-ice/saku-on-ice-cover.jpg" alt="Saku On Ice">
                <div class="commercial-info">
                    <h3 class="commercial-title">Saku On Ice</h3>
                </div>
            </div>
            <div class="commercial-card" onclick="location.href='projects/koik-on-tehtav.html'">
                <img src="images/commercial/koik-on-tehtav/koik-on-tehtav-cover.jpg" alt="Kõik on tehtav!">
                <div class="commercial-info">
                    <h3 class="commercial-title">Kõik on tehtav!</h3>
                </div>
            </div>
            <div class="commercial-card" onclick="location.href='projects/meliva-imago.html'">
                <img src="images/commercial/meliva-imago/meliva-imago-cover.jpg" alt="Meliva Imago">
                <div class="commercial-info">
                    <h3 class="commercial-title">Meliva Imago</h3>
                </div>
            </div>
            <div class="commercial-card" onclick="location.href='projects/coop-pank-kaardivagi.html'">
                <img src="images/commercial/coop-pank-kaardivagi/coop-pank-kaardivagi-cover.jpg" alt="Coop Pank Kaardivagi">
                <div class="commercial-info">
                    <h3 class="commercial-title">Coop Pank Kaardivagi</h3>
                </div>
            </div>
            <div class="commercial-card" onclick="location.href='projects/miljardid-protsendid.html'">
                <img src="images/commercial/miljardid-protsendid/miljardid-protsendid-cover.jpg" alt="Miljardid - Protsendid saavad otsa">
                <div class="commercial-info">
                    <h3 class="commercial-title">Miljardid - Protsendid saavad otsa</h3>
                </div>
            </div>
            <div class="commercial-card" onclick="location.href='projects/anna-arile-vunki.html'">
                <img src="images/commercial/anna-arile-vunki/anna-arile-vunki-cover.jpg" alt="Anna ärile vunki juurde!">
                <div class="commercial-info">
                    <h3 class="commercial-title">Anna ärile vunki juurde!</h3>
                </div>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="section">
        <h2 class="section-title"><span class="content-en">ABOUT</span><span class="content-ee">BIO</span></h2>
        <div class="about-content">
            <div class="content-en">
                <p class="about-text">
                    Triin Ruumet is an acclaimed Estonian film director whose distinctive vision and storytelling prowess have earned her a place on the international stage. Her original films, which she both writes and directs, have captivated audiences and critics alike, premiering at prestigious festivals such as the Karlovy Vary International Film Festival and the Tallinn Black Nights Film Festival.
                </p>
                <p class="about-text">
                    In addition to her celebrated film work, Ruumet is a skilled videographer, bringing a cinematic touch to a range of commercial projects. This includes agency-led social media campaigns that maintain a cinematic quality while meeting the unique demands of digital platforms.
                </p>
            </div>
            <div class="content-ee">
                <p class="about-text">
                    Triin Ruumet on tunnustatud eesti filmirežissöör, kelle ainulaadne visioon ja loojutustamisoskus on toonud talle rahvusvahelise tunnustuse. Ruumeti kirjutatud ja lavastatud originaalfilmid on lummanud nii publikut kui ka kriitikuid, esilinastudes mainekatel festivalidel, sealhulgas Karlovy Vary rahvusvahelisel filmifestivalil ja Pimedate Ööde filmifestivalil Tallinnas.
                </p>
                <p class="about-text">
                    Lisaks oma hinnatud filmitööle on Ruumet osav videograaf, tuues kinematograafilist hõngu erinevatesse kommertsprojektidesse ja sotsiaalmeedia kampaaniatesse. Nendes projektides püüdleb ta alati filmikvaliteedi saavutamise poole, vastates samas erinevate digikanalite nõudmistele.
                </p>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="section contact">
        <h2 class="section-title"><span class="content-en">CONTACT</span><span class="content-ee">KONTAKT</span></h2>
        <div class="contact-content">
            <div class="content-en">
                <p class="about-text">
                    Open to new opportunities and collaborations that align with a passion for storytelling, whether in film, commercial projects or social media.
                </p>
                <p class="about-text">
                    For any questions or enquiries please complete the form below
                </p>
            </div>
            <div class="content-ee">
                <p class="about-text">
                    Olen avatud uutele ideedele ja koostööle, mis on kooskõlas kirega jutustada lugusid, olgu selleks siis filmid, kommertsprojektid või sotsiaalmeedia kampaaniad.
                </p>
                <p class="about-text">
                    Ettepanekute puhul täida palun allolev vorm :)
                </p>
            </div>
            <form class="contact-form" id="contact-form">
                <div class="form-group">
                    <label for="name">
                        <span class="content-en">Name</span>
                        <span class="content-ee">Nimi</span>
                    </label>
                    <input type="text" id="name" name="name" required>
                </div>
                <div class="form-group">
                    <label for="email">
                        <span class="content-en">Email</span>
                        <span class="content-ee">Email</span>
                    </label>
                    <input type="email" id="email" name="email" required>
                </div>
                <div class="form-group">
                    <label for="project">
                        <span class="content-en">Project Type</span>
                        <span class="content-ee">Projekti Tüüp</span>
                    </label>
                    <input type="text" id="project" name="project" 
                           placeholder="Feature Film, Commercial, Documentary..." 
                           data-placeholder-en="Feature Film, Commercial, Documentary..."
                           data-placeholder-ee="Mängufilm, Reklaam, Dokumentaal...">
                </div>
                <div class="form-group">
                    <label for="message">
                        <span class="content-en">Message</span>
                        <span class="content-ee">Sõnum</span>
                    </label>
                    <textarea id="message" name="message" rows="5" required></textarea>
                </div>
                <button type="submit" class="submit-btn" id="submit-btn">
                    <span class="content-en">Send Message</span>
                    <span class="content-ee">Saada Sõnum</span>
                </button>
            </form>
        </div>
    </section>

    <script>
        // Advanced Language System with Geo-Detection and Persistence
        class LanguageManager {
            constructor() {
                this.defaultLang = 'en';
                this.currentLang = 'en';
                this.initialized = false;
                this.init();
            }

            async init() {
                // Check if user has a saved preference first
                const savedLang = localStorage.getItem('preferred-language');
                
                if (savedLang) {
                    // User has a preference, use it immediately
                    this.currentLang = savedLang;
                    console.log('Using saved language preference:', savedLang);
                    this.applyLanguage(this.currentLang);
                    this.updateLanguageButtons();
                    this.initialized = true;
                } else {
                    // Start with English default immediately
                    this.currentLang = 'en';
                    this.applyLanguage(this.currentLang);
                    this.updateLanguageButtons();
                    this.initialized = true;
                    
                    // Then detect location in background
                    try {
                        const detectedLang = await this.detectUserLocation();
                        if (detectedLang !== this.currentLang) {
                            console.log('Detected language for first-time visitor:', detectedLang);
                            this.currentLang = detectedLang;
                            this.applyLanguage(this.currentLang);
                            this.updateLanguageButtons();
                        }
                    } catch (error) {
                        console.log('Language detection failed, staying with English');
                    }
                }
            }

            async detectUserLocation() {
                try {
                    // Try to get user's country using a free IP geolocation service
                    const response = await fetch('https://ipapi.co/json/');
                    const data = await response.json();
                    
                    console.log('Detected country:', data.country_code);
                    
                    // If user is from Estonia, default to Estonian
                    if (data.country_code === 'EE') {
                        return 'ee';
                    }
                    
                    // Everyone else defaults to English
                    return 'en';
                    
                } catch (error) {
                    console.log('Geolocation detection failed, defaulting to English:', error);
                    return 'en';
                }
            }

            switchLanguage(lang) {
                this.currentLang = lang;
                
                // Save user's preference
                localStorage.setItem('preferred-language', lang);
                
                // Apply the language
                this.applyLanguage(lang);
                this.updateLanguageButtons();
                
                console.log('Language switched to:', lang);
            }

            applyLanguage(lang) {
                const body = document.body;
                
                if (lang === 'ee') {
                    body.classList.add('lang-ee');
                } else {
                    body.classList.remove('lang-ee');
                }
                
                // Update placeholders
                this.updatePlaceholders(lang);
            }

            updateLanguageButtons() {
                const buttons = document.querySelectorAll('.nav-lang-btn, .mobile-lang-btn');
                
                buttons.forEach(btn => {
                    btn.classList.remove('active');
                    
                    // Check if this button corresponds to current language
                    const onclick = btn.getAttribute('onclick');
                    if (onclick && onclick.includes(`'${this.currentLang}'`)) {
                        btn.classList.add('active');
                    }
                });
            }

            updatePlaceholders(lang) {
                const inputs = document.querySelectorAll('[data-placeholder-en][data-placeholder-ee]');
                
                inputs.forEach(input => {
                    const enPlaceholder = input.getAttribute('data-placeholder-en');
                    const eePlaceholder = input.getAttribute('data-placeholder-ee');
                    
                    if (lang === 'ee') {
                        input.placeholder = eePlaceholder;
                    } else {
                        input.placeholder = enPlaceholder;
                    }
                });
            }

            getCurrentLanguage() {
                return this.currentLang;
            }
        }

        // Initialize the language manager
        const languageManager = new LanguageManager();

        // Global function for onclick handlers
        function switchLanguage(lang) {
            languageManager.switchLanguage(lang);
            updateLanguageSwitcherAnimation(lang);
            updateMobileLanguageSwitcher(lang);
        }

        // Animated language switcher functionality
        function updateLanguageSwitcherAnimation(lang) {
            const switcher = document.querySelector('.nav-lang-switcher');
            if (switcher) {
                if (lang === 'ee') {
                    switcher.classList.add('ee-active');
                } else {
                    switcher.classList.remove('ee-active');
                }
            }
        }

        // Mobile language switcher functionality
        function updateMobileLanguageSwitcher(lang) {
            const mobileSwitcher = document.querySelector('.mobile-lang-switcher');
            const mobileButtons = document.querySelectorAll('.mobile-lang-btn');
            
            if (mobileSwitcher) {
                if (lang === 'ee') {
                    mobileSwitcher.classList.add('ee-active');
                } else {
                    mobileSwitcher.classList.remove('ee-active');
                }
            }
            
            // Update mobile button active states
            mobileButtons.forEach(btn => {
                btn.classList.remove('active');
                const onclick = btn.getAttribute('onclick');
                if (onclick && onclick.includes(`'${lang}'`)) {
                    btn.classList.add('active');
                }
            });
        }

        // Enhanced EmailJS form with language-aware messages
        function initializeContactForm() {
            const contactForm = document.getElementById('contact-form');
            if (!contactForm) return;

            contactForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Check if EmailJS is loaded
                if (typeof emailjs === 'undefined') {
                    console.error('EmailJS is not loaded');
                    alert('Email service is not available. Please try again later.');
                    return;
                }
                
                const submitBtn = document.getElementById('submit-btn');
                const originalText = submitBtn.innerHTML;
                
                // Get current language for messages
                const currentLang = languageManager.getCurrentLanguage();
                const isEstonian = currentLang === 'ee';
                
                // Show loading state
                if (isEstonian) {
                    submitBtn.innerHTML = 'Saadan...';
                } else {
                    submitBtn.innerHTML = 'Sending...';
                }
                submitBtn.disabled = true;
                
                // Get form data
                const templateParams = {
                    from_name: document.getElementById('name').value,
                    from_email: document.getElementById('email').value,
                    project_type: document.getElementById('project').value,
                    message: document.getElementById('message').value
                };
                
                console.log('Sending email with params:', templateParams);
                
                // Send email using EmailJS
                emailjs.send('service_jcm6n1o', 'template_4t3k57a', templateParams)
                    .then(function(response) {
                        console.log('SUCCESS!', response.status, response.text);
                        
                        // Success message in current language
                        const successMessage = isEstonian ? 
                            'Aitäh sõnumi eest! Võtan teiega peagi ühendust.' :
                            'Thank you for your message! I will get back to you soon.';
                        
                        alert(successMessage);
                        
                        // Reset form
                        contactForm.reset();
                        
                    })
                    .catch(function(error) {
                        console.log('FAILED...', error);
                        
                        // Error message in current language
                        let errorMessage;
                        if (error.status === 418) {
                            errorMessage = isEstonian ? 
                                'Emaili teenuse viga. Kontrollige teenuse seadistusi.' :
                                'Email service error. Please check service settings.';
                        } else if (error.status === 400) {
                            errorMessage = isEstonian ? 
                                'Viga sõnumi vormingus. Kontrollige kõiki välju.' :
                                'Error in message format. Please check all fields.';
                        } else {
                            errorMessage = isEstonian ? 
                                'Viga sõnumi saatmisel. Proovige uuesti.' :
                                'Error sending message. Please try again.';
                        }
                        
                        alert(errorMessage);
                    })
                    .finally(function() {
                        // Reset button state
                        submitBtn.innerHTML = originalText;
                        submitBtn.disabled = false;
                    });
            });
        }

        // Page Transitions System
        function initializePageTransitions() {
            // Create transition overlay
            const overlay = document.createElement('div');
            overlay.className = 'page-transition-overlay';
            document.body.appendChild(overlay);
            
            // Add page loaded class after initial load
            setTimeout(() => {
                document.body.classList.add('page-loaded');
            }, 100);
            
            // Handle all navigation links
            document.querySelectorAll('a[href]').forEach(link => {
                // Skip external links, anchors, and mailto links
                const href = link.getAttribute('href');
                if (href.startsWith('#') || href.startsWith('mailto:') || href.startsWith('http')) {
                    return;
                }
                
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Show transition overlay
                    overlay.classList.add('active');
                    document.body.classList.add('page-loading');
                    
                    // Navigate after transition
                    setTimeout(() => {
                        window.location.href = href;
                    }, 300);
                });
            });
            
            // Handle browser back/forward
            window.addEventListener('pageshow', function() {
                overlay.classList.remove('active');
                document.body.classList.remove('page-loading');
                document.body.classList.add('page-loaded');
            });
        }

        function initializeNavigation() {
            // Mobile menu toggle
            const hamburger = document.querySelector('.hamburger');
            const navMenu = document.querySelector('.nav-menu');

            if (hamburger && navMenu) {
                hamburger.addEventListener('click', () => {
                    // Toggle hamburger and menu
                    hamburger.classList.toggle('active');
                    navMenu.classList.toggle('active');
                });

                // Close menu when clicking on a link
                document.querySelectorAll('.nav-menu a').forEach(link => {
                    link.addEventListener('click', () => {
                        hamburger.classList.remove('active');
                        navMenu.classList.remove('active');
                    });
                });
            }

            // Navigation scroll effect
            window.addEventListener('scroll', () => {
                const nav = document.querySelector('.nav');
                if (window.scrollY > 50) {
                    nav.classList.add('scrolled');
                } else {
                    nav.classList.remove('scrolled');
                }
            });

            // Smooth scrolling for navigation links (only on home page)
            if (document.body.classList.contains('home-page')) {
                document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                    anchor.addEventListener('click', function (e) {
                        e.preventDefault();
                        const target = document.querySelector(this.getAttribute('href'));
                        if (target) {
                            target.scrollIntoView({
                                behavior: 'smooth',
                                block: 'start'
                            });
                        }
                    });
                });
            }
        }

        // Initialize everything when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize contact form if it exists
            initializeContactForm();
            
            // Initialize page transitions
            initializePageTransitions();
            
            // Initialize navigation
            initializeNavigation();
        });
    </script>
</body>
</html>